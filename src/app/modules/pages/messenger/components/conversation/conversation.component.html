<div class="conversation-container card relative">
    <div class="flex flex-col h-full">
        <div class="conversation-top flex items-center justify-between top-4">
            <div class="conversation-info flex items-center m-3">
                <div class="conversation-avatar">
                    <img src="../../../../../../assets/san-marco.jpg" alt="user-avatar" class="avatar-medium">
                </div>
                <div class="conversation-info flex flex-col ml-3">
                    <span>Leslie Alexander</span>
                    <span>Active now</span>
                </div>
            </div>
            <div class="conversation-options flex items-center">
                <mat-icon class="mr-3">close</mat-icon>
            
                <mat-icon class="mr-3">close</mat-icon>
            
                <mat-icon class="mr-3">close</mat-icon>
            </div>
        </div>

        <div class="message-container flex flex-col overflow-y-scroll m-3 pr-2 grow">
            <div class="message flex" *ngFor="let message of messages" [class.own]="message.own">
                <!-- avatar -->
                <div *ngIf="!message.own && ['last', 'single'].includes(getMessageOrder(message))" class="avatar-container flex items-end justify-center mr-2">
                    <img [src]="message.user?.avatar" class="avatar-medium">
                </div>
                <!-- text only message -->
                <div 
                    class="message-text-container flex w-full" 
                    *ngIf="!message.image"
                    [class.own]="message.own"
                    [class.flex-col]="message.repliedTo"
                    [ngClass]="message.repliedTo ? 'mt-3' : 'mt-0.5'"
                    >    
                    <span 
                        *ngIf="!message.own && message.repliedTo?.content"
                        [class.not-last-message]="!message.own && !isLastMessage(message)" 
                    >
                        Leslie Alexander replied to you
                    </span>
                    <span 
                        *ngIf="message.own && message.repliedTo?.content"
                        [class.not-last-message]="!message.own && !isLastMessage(message)" 
                    >
                        You replied to Leslie Alexander
                    </span>
                    <div 
                        *ngIf="message.repliedTo?.content"
                        [class.not-last-message]="!message.own && !isLastMessage(message)" 
                        class="replied-to long-text">
                        <span>
                            {{ message.repliedTo?.content }}
                        </span>
                    </div>
                    <div 
                        class="message-text long-text"
                        [class.not-last-message]="!['last', 'single'].includes(getMessageOrder(message))"
                        [class.first-message]="getMessageOrder(message) == 'first'"
                        [class.middle-message]="getMessageOrder(message) == 'middle'"
                        [class.last-message]="getMessageOrder(message) == 'last'"
                        [class.single-message]="getMessageOrder(message) == 'single'"
                    >
                        <span *ngIf="message.content">
                            {{ message.content }}
                        </span>
                    </div>
                </div>
                <!-- image message -->
                <div 
                    class="message-image flex w-full" 
                    *ngIf="message.image" 
                    [class.flex-col]="message.repliedTo"
                    [ngClass]="message.repliedTo ? 'mt-3' : 'mt-0.5'"
                >
                    <span 
                        *ngIf="!message.own && message.repliedTo?.content"
                    >
                        Leslie Alexander replied to you
                    </span>
                    <span 
                        *ngIf="message.own && message.repliedTo?.content"
                    >
                        You replied to Leslie Alexander
                    </span>
                    <div 
                        *ngIf="message.repliedTo?.content" 
                        class="replied-to long-text">
                        <span>
                            {{ message.repliedTo.content }}
                        </span>
                    </div>
                    <app-image
                        [src]="message.image"
                        [classes]="{
                            'message-image': true,
                            'with-text': !!message.content,
                            'not-last-message': !['last', 'single'].includes(getMessageOrder(message)),
                            'first-message': getMessageOrder(message) === 'first',
                            'middle-message': getMessageOrder(message) === 'middle',
                            'last-message': getMessageOrder(message) === 'last',
                            'single-message': getMessageOrder(message) === 'single'
                          }"
                        [style.z-index]="10"
                        [width]="300"
                        [height]="200"
                    />
                </div>
                <!-- notify text -->
            </div>
            <div class="flex items-center justify-center mt-3">
                <span (click)="onClick()">29 Jun 2024, 14:38</span>
                <app-image src="../../../../../../assets/avatar-2.png" alt="image"></app-image>
            </div>
        </div>

        <div class="conversation-chat w-full">
            <div class="mb-3 mt-1 flex items-center px-3">
                <mat-icon class="mr-3">close</mat-icon>
                <mat-icon class="mr-3">add_to_photos</mat-icon>
                <mat-icon class="mr-3">attach_file</mat-icon>
                <mat-icon class="mr-3">gif</mat-icon>
                <div class="conversation-input grow mr-3">
                    <mat-form-field class="w-full">
                        <input matInput type="text" placeholder="Aa">
                            <mat-icon matSuffix>sentiment_satisfied_alt</mat-icon>
                    </mat-form-field>
                </div>
                <mat-icon>thumb_up</mat-icon>
            </div>
        </div>
    </div>
</div>
